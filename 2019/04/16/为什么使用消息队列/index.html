<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="cHqsYC3VKh"><!--百度-->
  <meta name="360-site-verification" content="3bfff55669ee5569ddd583d4e57cbae8"><!--360-->
  <meta name="sogou_site_verification" content="y4IFS8seKn"><!--搜狗 验证不成功-->
  <meta name="google-site-verification" content="2qH4bOdXGa7Pk1tuRp6ePLAGiP6K3H07EUYDPo_Ugp4"><!--谷歌-->
  
  <title>为什么使用消息队列 | 去年夏天</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="栈：先进先出。堆、队列：先进后出。 队列队列（常用数据结构之一）。队列是一种特殊的线性表，特殊之处在于它只允许在表的前端（front）进行删除操作，而在表的后端（rear）进行插入操作，和栈一样，队列是一种操作受限制的线性表。进行插入操作的端称为队尾，进行删除操作的端称为队头。消息被发送到队列中，“消息队列”是在消息的传输过程中保存消息的容器。消息队列管理器在将消息从它的源中继到它的目标时充当中间">
<meta name="keywords" content="Queue">
<meta property="og:type" content="article">
<meta property="og:title" content="为什么使用消息队列">
<meta property="og:url" content="http://lastsummer.top/blog/2019/04/16/为什么使用消息队列/index.html">
<meta property="og:site_name" content="去年夏天">
<meta property="og:description" content="栈：先进先出。堆、队列：先进后出。 队列队列（常用数据结构之一）。队列是一种特殊的线性表，特殊之处在于它只允许在表的前端（front）进行删除操作，而在表的后端（rear）进行插入操作，和栈一样，队列是一种操作受限制的线性表。进行插入操作的端称为队尾，进行删除操作的端称为队头。消息被发送到队列中，“消息队列”是在消息的传输过程中保存消息的容器。消息队列管理器在将消息从它的源中继到它的目标时充当中间">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://lastsummer.top/blog/2019/04/16/为什么使用消息队列/rabbitmq1.png">
<meta property="og:updated_time" content="2019-04-16T09:36:15.934Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="为什么使用消息队列">
<meta name="twitter:description" content="栈：先进先出。堆、队列：先进后出。 队列队列（常用数据结构之一）。队列是一种特殊的线性表，特殊之处在于它只允许在表的前端（front）进行删除操作，而在表的后端（rear）进行插入操作，和栈一样，队列是一种操作受限制的线性表。进行插入操作的端称为队尾，进行删除操作的端称为队头。消息被发送到队列中，“消息队列”是在消息的传输过程中保存消息的容器。消息队列管理器在将消息从它的源中继到它的目标时充当中间">
<meta name="twitter:image" content="http://lastsummer.top/blog/2019/04/16/为什么使用消息队列/rabbitmq1.png">
  
    <link rel="alternate" href="/atom.xml" title="去年夏天" type="application/atom+xml">
  
  
    <link rel="icon" href="https://pic.qqtn.com/up/2018-9/15368261867401976.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
  <link rel="stylesheet" href="/blog/plugin/bganimation/bg.css">
  

  <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
  .pace .pace-progress {
	  background: #7d7dff; /*进度条颜色*/
	  height: 3px;
  }
  .pace .pace-progress-inner {
	   box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
  }
  .pace .pace-activity {
	  border-top-color: #1E92FB;    /*上边框颜色*/
	  border-left-color: #1E92FB;    /*左边框颜色*/
  }
</style><!--进度条-->
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://pic.qqtn.com/up/2018-9/15368261867401976.jpg">
    <h2 class="author">Wang Rui</h2>
    <h3 class="description">做自己爱做的事，爱自己在做的事！</h3>
    <div class="count-box">
      <a href="/archives"><div><strong>38</strong><br>文章</div></a>
      <a href="/categories"><div><strong>14</strong><br>分类</div></a>
      <a href="/tags"><div><strong>32</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/blog" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/blog/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/blog/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/blog/tags" title="Tags">
            <li>标签</li>
          </a>
        
          <a href="/blog/about" title="关于">
            <li>关于</li>
          </a>
        
          <a href="/blog/photos" title="相册">
            <li>相册</li>
          </a>
        
          <a href="/blog/生活" title="生活">
            <li>生活</li>
          </a>
        
          <a href="/blog/reward" title="文件">
            <li>文件</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-为什么使用消息队列" class="wow slideInRight article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2019/04/16/为什么使用消息队列/" class="article-date">
  <time class="post-time" datetime="2019-04-16T07:00:53.000Z" itemprop="datePublished">
    <span class="post-month">4月</span><br>
    <span class="post-day">16</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      为什么使用消息队列
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/queue/">queue</a>
  </div>

          
              
  &nbsp; | &nbsp;
  <div class="view-box">
    <span id="/blog/2019/04/16/为什么使用消息队列/" class="leancloud_visitors" data-flag-title="为什么使用消息队列">
      &nbsp;阅读次数<span class="leancloud-visitors-count"></span>
    </span>
  </div>


          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
		
      <div id="toc" class="toc-article">
      <strong class="toc-title">文章目录</strong>
      
      </div>
    
      <!-- 目录内容 -->

    <p class="show-toc-btn" id="show-toc-btn" onclick="showToc();" style="display:none">
          <span class="btn-bg"></span>
          <span class="btn-text">文章导航</span>
          </p>
    <div id="toc-article" class="toc-article">
        <span id="toc-close" class="toc-close" title="隐藏导航" onclick="showBtn();">×</span>
        <strong class="toc-title">文章目录</strong>
           <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#队列"><span class="toc-number">1.</span> <span class="toc-text">队列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#面试题"><span class="toc-number">2.</span> <span class="toc-text">面试题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#为什么使用消息队列？（场景、优点、缺点）"><span class="toc-number">2.1.</span> <span class="toc-text">为什么使用消息队列？（场景、优点、缺点）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#解耦"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">解耦</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#异步"><span class="toc-number">2.1.0.2.</span> <span class="toc-text">异步</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#削峰"><span class="toc-number">2.1.0.3.</span> <span class="toc-text">削峰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#消息队列有什么优点和缺点？"><span class="toc-number">2.2.</span> <span class="toc-text">消息队列有什么优点和缺点？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）"><span class="toc-number">2.2.1.</span> <span class="toc-text">优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）"><span class="toc-number">2.2.2.</span> <span class="toc-text">缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#系统可用性降低："><span class="toc-number">2.2.2.1.</span> <span class="toc-text">系统可用性降低：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#系统复杂度提高"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">系统复杂度提高</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一致性问题"><span class="toc-number">2.2.2.3.</span> <span class="toc-text">一致性问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Kafka、ActiveMQ、RabbitMQ、RocketMQ-都有什么区别，以及适合哪些场景？"><span class="toc-number">2.3.</span> <span class="toc-text">Kafka、ActiveMQ、RabbitMQ、RocketMQ 都有什么区别，以及适合哪些场景？</span></a></li></ol>
         </div>
   <script type="text/javascript">
    function showToc(){
        var toc_article = document.getElementById("toc-article");
        var show_toc_btn = document.getElementById("show-toc-btn");
        toc_article.setAttribute("style","display:block");
        show_toc_btn.setAttribute("style","display:none");
        };
    function showBtn(){
        var toc_article = document.getElementById("toc-article");
        var show_toc_btn = document.getElementById("show-toc-btn");
        toc_article.setAttribute("style","display:none");
        show_toc_btn.setAttribute("style","display:block");
        };
   </script>
   
<!-- 目录内容结束 -->
<style>
/* 新添加的 */
#container .show-toc-btn,#container .toc-article{display:block}
.toc-article{z-index:100;background:#fff;border:1px solid #ccc;max-width:250px;min-width:150px;max-height:500px;overflow-y:auto;-webkit-box-shadow:5px 5px 2px #ccc;box-shadow:5px 5px 2px #ccc;font-size:12px;padding:10px;position:fixed;right:35px;top:129px}.toc-article .toc-close{font-weight:700;font-size:20px;cursor:pointer;float:right;color:#ccc}.toc-article .toc-close:hover{color:#000}.toc-article .toc{font-size:12px;padding:0;line-height:20px}.toc-article .toc .toc-number{color:#333}.toc-article .toc .toc-text:hover{text-decoration:underline;color:#2a6496}.toc-article li{list-style-type:none}.toc-article .toc-level-1{margin:4px 0}.toc-article .toc-child{}@-moz-keyframes cd-bounce-1{0%{opacity:0;-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}60%{opacity:1;-o-transform:scale(1.01);-webkit-transform:scale(1.01);-moz-transform:scale(1.01);-ms-transform:scale(1.01);transform:scale(1.01)}100%{-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-webkit-keyframes cd-bounce-1{0%{opacity:0;-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}60%{opacity:1;-o-transform:scale(1.01);-webkit-transform:scale(1.01);-moz-transform:scale(1.01);-ms-transform:scale(1.01);transform:scale(1.01)}100%{-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@-o-keyframes cd-bounce-1{0%{opacity:0;-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}60%{opacity:1;-o-transform:scale(1.01);-webkit-transform:scale(1.01);-moz-transform:scale(1.01);-ms-transform:scale(1.01);transform:scale(1.01)}100%{-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes cd-bounce-1{0%{opacity:0;-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}60%{opacity:1;-o-transform:scale(1.01);-webkit-transform:scale(1.01);-moz-transform:scale(1.01);-ms-transform:scale(1.01);transform:scale(1.01)}100%{-o-transform:scale(1);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.show-toc-btn{display:none;z-index:10;width:30px;min-height:14px;overflow:hidden;padding:4px 6px 8px 5px;border:1px solid #ddd;border-right:none;position:fixed;right:40px;text-align:center;background-color:#f9f9f9}.show-toc-btn .btn-bg{margin-top:2px;display:block;width:16px;height:14px;background:url(http://7xtawy.com1.z0.glb.clouddn.com/show.png) no-repeat;-webkit-background-size:100%;-moz-background-size:100%;background-size:100%}.show-toc-btn .btn-text{color:#999;font-size:12px}.show-toc-btn:hover{cursor:pointer}.show-toc-btn:hover .btn-bg{background-position:0 -16px}.show-toc-btn:hover .btn-text{font-size:12px;color:#ea8010}
.toc-article li ol, .toc-article li ul {
    margin-left: 30px;
}
.toc-article ol, .toc-article ul {
    margin: 10px 0;
}

</style>
        <p>栈：先进先出。<br>堆、队列：先进后出。</p>
<h3 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h3><p>队列（常用数据结构之一）。<br>队列是一种特殊的线性表，特殊之处在于它只允许在表的前端（front）进行删除操作，而在表的后端（rear）进行插入操作，和栈一样，队列是一种操作受限制的线性表。进行插入操作的端称为队尾，进行删除操作的端称为队头。<br>消息被发送到队列中，“消息队列”是在消息的传输过程中保存消息的容器。<br>消息队列管理器在将消息从它的源中继到它的目标时充当中间人。<br>队列的主要目的是提供路由并保证消息的传递。<br>如果发送消息时接收者不可用，消息队列会保留消息，直到可以成功地传递它。《百度百科》<br><a id="more"></a></p>
<h3 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h3><h4 id="为什么使用消息队列？（场景、优点、缺点）"><a href="#为什么使用消息队列？（场景、优点、缺点）" class="headerlink" title="为什么使用消息队列？（场景、优点、缺点）"></a>为什么使用消息队列？（场景、优点、缺点）</h4><h6 id="解耦"><a href="#解耦" class="headerlink" title="解耦"></a>解耦</h6><p>场景A：<br>A 系统发送数据到 BCD 三个系统，通过接口调用发送。如果 E 系统也要这个数据呢？那如果 C 系统现在不需要了呢？A 系统负责人几乎崩溃……在这个场景中，A 系统跟其它各种乱七八糟的系统严重耦合，A 系统产生一条比较关键的数据，很多系统都需要 A 系统将这个数据发送过来。A 系统要时时刻刻考虑 BCDE 四个系统如果挂了该咋办？要不要重发，要不要把消息存起来？头发都白了啊！<br>场景A使用MQ：<br>如果使用 MQ，A 系统产生一条数据，发送到 MQ 里面去，哪个系统需要数据自己去 MQ 里面消费。如果新系统需要数据，直接从 MQ 里消费即可；如果某个系统不需要这条数据了，就取消对 MQ 消息的消费即可。这样下来，A 系统压根儿不需要去考虑要给谁发送数据，不需要维护这个代码，也不需要考虑人家是否调用成功、失败超时等情况。<br>总结：<br>通过一个 MQ，Pub/Sub 发布订阅消息这么一个模型，A 系统就跟其它系统彻底解耦了。<br>面试技巧：<br>你需要去考虑一下你负责的系统中是否有类似的场景，就是一个系统或者一个模块，调用了多个系统或者模块，互相之间的调用很复杂，维护起来很麻烦。但是其实这个调用是不需要直接同步调用接口的，如果用 MQ 给它异步化解耦，也是可以的，你就需要去考虑在你的项目里，是不是可以运用这个 MQ 去进行系统的解耦。在简历中体现出来这块东西，用 MQ 作解耦。</p>
<h6 id="异步"><a href="#异步" class="headerlink" title="异步"></a>异步</h6><p>场景B：<br>A 系统接收一个请求，需要在自己本地写库，还需要在 BCD 三个系统写库，自己本地写库要 3ms，BCD 三个系统分别写库要 300ms、450ms、200ms。最终请求总延时是 3 + 300 + 450 + 200 = 953ms，接近 1s，用户感觉搞个什么东西，慢死了慢死了。用户通过浏览器发起请求，等待个 1s，这几乎是不可接受的。一般互联网类的企业，对于用户直接的操作，一般要求是每个请求都必须在 200 ms 以内完成，对用户几乎是无感知的。<br>场景B使用MQ：<br>如果使用 MQ，那么 A 系统连续发送 3 条消息到 MQ 队列中，假如耗时 5ms，A 系统从接受一个请求到返回响应给用户，总时长是 3 + 5 = 8ms，对于用户而言，其实感觉上就是点个按钮，8ms 以后就直接返回了，爽！网站做得真好，真快！</p>
<h6 id="削峰"><a href="#削峰" class="headerlink" title="削峰"></a>削峰</h6><p>场景C：<br>每天 0:00 到 12:00，A 系统风平浪静，每秒并发请求数量就 50 个。结果每次一到 12:00 ~ 13:00 ，每秒并发请求数量突然会暴增到 5k+ 条。但是系统是直接基于 MySQL 的，大量的请求涌入 MySQL，每秒钟对 MySQL 执行约 5k 条 SQL。一般的 MySQL，扛到每秒 2k 个请求就差不多了，如果每秒请求到 5k 的话，可能就直接把 MySQL 给打死了，导致系统崩溃，用户也就没法再使用系统了。但是高峰期一过，到了下午的时候，就成了低峰期，可能也就 1w 的用户同时在网站上操作，每秒中的请求数量可能也就 50 个请求，对整个系统几乎没有任何的压力。<br>场景C使用MQ：<br>如果使用 MQ，每秒 5k 个请求写入 MQ，A 系统每秒钟最多处理 2k 个请求，因为 MySQL 每秒钟最多处理 2k 个。A 系统从 MQ 中慢慢拉取请求，每秒钟就拉取 2k 个请求，不要超过自己每秒能处理的最大请求数量就 ok，这样下来，哪怕是高峰期的时候，A 系统也绝对不会挂掉。而 MQ 每秒钟 5k 个请求进来，就 2k 个请求出去，结果就导致在中午高峰期（1 个小时），可能有几十万甚至几百万的请求积压在 MQ 中。这个短暂的高峰期积压是 ok 的，因为高峰期过了之后，每秒钟就 50 个请求进 MQ，但是 A 系统依然会按照每秒 2k 个请求的速度在处理。所以说，只要高峰期一过，A 系统就会快速将积压的消息给解决掉。</p>
<h4 id="消息队列有什么优点和缺点？"><a href="#消息队列有什么优点和缺点？" class="headerlink" title="消息队列有什么优点和缺点？"></a>消息队列有什么优点和缺点？</h4><h5 id="优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）"><a href="#优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）" class="headerlink" title="优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）"></a>优点：上面已经说了，就是在特殊场景下有其对应的好处，解耦、异步、削峰（三个）</h5><h5 id="缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）"><a href="#缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）" class="headerlink" title="缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）"></a>缺点：系统可用性降低、系统复杂度提高、一致性问题（三个）</h5><h6 id="系统可用性降低："><a href="#系统可用性降低：" class="headerlink" title="系统可用性降低："></a>系统可用性降低：</h6><p>系统引入的外部依赖越多，越容易挂掉。本来你就是 A 系统调用 BCD 三个系统的接口就好了，人 ABCD 四个系统好好的，没啥问题，你偏加个 MQ 进来，万一 MQ 挂了咋整，MQ 一挂，整套系统崩溃的，你不就完了？如何保证消息队列的高可用，可以点击这里查看。</p>
<h6 id="系统复杂度提高"><a href="#系统复杂度提高" class="headerlink" title="系统复杂度提高"></a>系统复杂度提高</h6><p>硬生生加个 MQ 进来，你怎么保证消息没有重复消费？怎么处理消息丢失的情况？怎么保证消息传递的顺序性？头大头大，问题一大堆，痛苦不已。</p>
<h6 id="一致性问题"><a href="#一致性问题" class="headerlink" title="一致性问题"></a>一致性问题</h6><p>A 系统处理完了直接返回成功了，人都以为你这个请求就成功了；但是问题是，要是 BCD 三个系统那里，BD 两个系统写库成功了，结果 C 系统写库失败了，咋整？你这数据就不一致了。</p>
<h4 id="Kafka、ActiveMQ、RabbitMQ、RocketMQ-都有什么区别，以及适合哪些场景？"><a href="#Kafka、ActiveMQ、RabbitMQ、RocketMQ-都有什么区别，以及适合哪些场景？" class="headerlink" title="Kafka、ActiveMQ、RabbitMQ、RocketMQ 都有什么区别，以及适合哪些场景？"></a>Kafka、ActiveMQ、RabbitMQ、RocketMQ 都有什么区别，以及适合哪些场景？</h4><p>所以消息队列实际是一种非常复杂的架构，你引入它有很多好处，但是也得针对它带来的坏处做各种额外的技术方案和架构来规避掉，做好之后，你会发现，妈呀，系统复杂度提升了一个数量级，也许是复杂了 10 倍。但是关键时刻，用，还是得用的。</p>
<p><img src="/blog/2019/04/16/为什么使用消息队列/rabbitmq1.png" alt="四大MQ的优缺点"></p>
<p>综上，各种对比之后，有如下建议：<br>1、一般的业务系统要引入 MQ，最早大家都用 ActiveMQ，但是现在确实大家用的不多了，没经过大规模吞吐量场景的验证，社区也不是很活跃，所以大家还是算了吧，我个人不推荐用这个了；<br>2、后来大家开始用 RabbitMQ，但是确实 erlang 语言阻止了大量的 Java 工程师去深入研究和掌控它，对公司而言，几乎处于不可控的状态，但是确实人家是开源的，比较稳定的支持，活跃度也高；<br>3、不过现在确实越来越多的公司会去用 RocketMQ，确实很不错，毕竟是阿里出品，但社区可能有突然黄掉的风险（目前 RocketMQ 已捐给 Apache，但 GitHub 上的活跃度其实不算高）对自己公司技术实力有绝对自信的，推荐用 RocketMQ，否则回去老老实实用 RabbitMQ 吧，人家有活跃的开源社区，绝对不会黄。<br>所以中小型公司，技术实力较为一般，技术挑战不是特别高，用 RabbitMQ 是不错的选择；<br>大型公司，基础架构研发实力较强，用 RocketMQ 是很好的选择。<br>如果是大数据领域的实时计算、日志采集等场景，用 Kafka 是业内标准的，绝对没问题，社区活跃度很高，绝对不会黄，何况几乎是全世界这个领域的事实性规范。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://lastsummer.top/blog/2019/04/16/为什么使用消息队列/" data-id="ck39ngsvp0039ysvbkrkunmua" class="article-share-link-test"></a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Queue/">Queue</a></li></ul>

    </footer>
	
	
	  
    <!--MOB SHARE BEGIN-->
	<div class="-mob-share-ui-button -mob-share-open">分享</div>
	<div class="-mob-share-ui" style="display: none">
		<ul class="-mob-share-list">
			<li class="-mob-share-weibo"><p>新浪微博</p></li>
			<li class="-mob-share-tencentweibo"><p>腾讯微博</p></li>
			<li class="-mob-share-qzone"><p>QQ空间</p></li>
			<li class="-mob-share-qq"><p>QQ好友</p></li>
			<li class="-mob-share-weixin"><p>微信</p></li>
			<li class="-mob-share-douban"><p>豆瓣</p></li>
			<li class="-mob-share-renren"><p>人人网</p></li>
			<li class="-mob-share-kaixin"><p>开心网</p></li>
			<li class="-mob-share-facebook"><p>Facebook</p></li>
			<li class="-mob-share-twitter"><p>Twitter</p></li>
			<li class="-mob-share-pocket"><p>Pocket</p></li>
			<li class="-mob-share-google"><p>Google+</p></li>
			<li class="-mob-share-youdao"><p>有道云笔记</p></li>
			<li class="-mob-share-mingdao"><p>明道</p></li>
			<li class="-mob-share-pengyou"><p>朋友网</p></li>
			<li class="-mob-share-tumblr"><p>Tumblr</p></li>
			<li class="-mob-share-instapaper"><p>Instapaper</p></li>
			<li class="-mob-share-linkedin"><p>LinkedIn</p></li>
		</ul>
		<div class="-mob-share-close">取消</div>
	</div>
	<div class="-mob-share-ui-bg"></div>
	<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=283bca7b96411"></script>
	<!--MOB SHARE END-->
	
	
  </div>
  
  
    
<nav id="article-nav">
  
    <a href="/blog/2019/04/17/Window10安装RabbitMq中间件/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Window10安装RabbitMq中间件
        
      </div>
    </a>
  
  
    <a href="/blog/2019/03/04/Git基本命令/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Git基本命令</div>
    </a>
  
</nav>

  

	
  
</article>








	<!--PC和WAP自适应版 sid="请将此处替换为配置SourceID的语句"-->
<div id="SOHUCS"></div> 
<script type="text/javascript"> 
(function(){ 
var appid = 'cytRJBBqd'; 
var conf = '6c62cf127e7cfd66a7c253c93daeda6e'; 
var width = window.innerWidth || document.documentElement.clientWidth; 
if (width < 960) { 
window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })(); </script>




  <script type="text/javascript" src="https://lastsummer.top/blog/js/tctip-1.0.2.js"></script>
<script>
  new tctip({
    top: '20%',
    button: {
      id: 9,
      type: 'zanzhu'
    },
    list: [
      {
        type: 'alipay',
        qrImg: 'https://lastsummer.top/blog/photos/donate/zhifubao.jpg'
      }, {
        type: 'wechat',
        qrImg: 'https://lastsummer.top/blog/photos/donate/weixin.png'
      }
    ]
  }).init()
</script>

</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap" style="width:225px;margin-top:50px;">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">去年夏天</h1>
    <h2 class="blog-subtitle"></h2>
    <ul class="blog-link">
     
          <a href="/blog" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/blog/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/blog/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/blog/tags" title="Tags">
            <li>标签</li>
          </a>
        
          <a href="/blog/about" title="关于">
            <li>关于</li>
          </a>
        
          <a href="/blog/photos" title="相册">
            <li>相册</li>
          </a>
        
          <a href="/blog/生活" title="生活">
            <li>生活</li>
          </a>
        
          <a href="/blog/reward" title="文件">
            <li>文件</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap" style="width:225px;">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://pic.qqtn.com/up/2018-9/15368261867401976.jpg">
    <h2 class="author">Wang Rui</h2>
    <h3 class="description">做自己爱做的事，爱自己在做的事！</h3>
    <div class="count-box">
      <a href="/blog/archives"><div><strong>38</strong><br>文章</div></a>
      <a href="/blog/categories"><div><strong>14</strong><br>分类</div></a>
      <a href="/blog/tags"><div><strong>32</strong><br>标签</div></a>
    </div>
	<div id="site_search" align="center" style="margin:15px 0 0 0;">
	  <input type="text" id="local-search-input" name="q" results="0" placeholder="本站搜索" style="width:180px;height:25px;">
	  <div id="local-search-result"></div>
	</div>
    <div align="center" style="margin:15px 0 0 0;">
      <input type="text" id="guge" name="guge" results="0" placeholder="谷歌搜索" style="width:180px;height:25px;">
    </div>
	<div align="center" style="margin:15px 0 0 0;">
      <i class="fa fa-rss fa-2x" aria-hidden="true" id="rss"></i>
    </div>
    
    
    <div class="friend-link">
      <h2>社交链接</h2>
      
        <a class="hvr-bounce-in" href="https://github.com/wangrui15034005712" target="_blank" title="Github">
          Github
        </a>
      
        <a class="hvr-bounce-in" href="https://dev.tencent.com/u/wangrui15034005712" target="_blank" title="Coding">
          Coding
        </a>
      
    </div>
    

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="http://lastsummer.top/" target="_blank" title="LastSummer">
          LastSummer
        </a>
      
        <a class="hvr-bounce-in" href="http://blog.shanamaid.top/" target="_blank" title="ShanaMaid">
          ShanaMaid
        </a>
      
    </div>

    <div class="friend-link">
        <h2>音乐鉴赏</h2>
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="200" height="86" src="//music.163.com/outchain/player?type=2&id=1306515028&auto=0&height=66"></iframe>
    </div>
  </div>
</div>


  <div class="widget tag">
    <h2><font style="font-size: 15px;font-weight: bold;padding: 10px 0px;">归档</font></h2>
	<div style="margin-top:6px;"></div>
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/11/">2019年11月</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/10/">2019年10月</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/07/">2019年07月</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/06/">2019年06月</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/05/">2019年05月</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/04/">2019年04月</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/03/">2019年03月</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2019/01/">2019年01月</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/12/">2018年12月</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/11/">2018年11月</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/10/">2018年10月</a><span class="archive-list-count">10</span></li></ul>
  </div>


<div class="widget-wrap" style="width:225px;">
  <div class="widget">
    <h2><font style="font-size: 15px;font-weight: bold;padding: 10px 0px;">最新文章</font></h2>
    <div class="tag-link" id="taglink">

    </div>
  </div>
</div>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns" crossorigin="anonymous">
<style>
  .tag-link{
    overflow:hidden;
    text-overflow:ellipsis;
    -o-text-overflow:ellipsis;
    white-space:nowrap;
    width:100%;
  }
</style>
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script>
var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        success: function( xmlResponse ) {
            // get the contents from search data
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var string1 = "";
            var count = 0;
             datas.forEach(function(data) {
               count++;
               var title = data.title;
               if(count <= 20){
                var url = 'https://lastsummer.top/' + data.url;
                 string1 += "<span><a title='"+title+"' href='"+  url +"'>"+ title +"</a></span><br>";
               }
             });
             $('#taglink').html(string1);
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length <= 0) {
                    return;
                }
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    data_url = 'https://lastsummer.top/' + data_url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 100;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substr(start, end); 
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<em class=\"search-keyword\">"+keyword+"</em>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                });
                str += "</ul>";
                $resultContent.innerHTML = str;
            });
        }
    });
}

	var search_path = "blog/search.xml";
     if (search_path.length == 0) {
     	search_path = "search.xml";
     }
     var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
	 
	 $('#guge').blur(function () {
            window.open("https://www.google.com.hk/search?q=site%3Alastsummer.top");
        });
	 $('#rss').click(function () {	
		window.open("https://lastsummer.top/blog/atom.xml");
	 });
</script>
  
</aside>
        
      </div>
      <footer id="footer" style="border:none;color:#ffffff;background:none;">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2019-11-22 Fr Wang Rui<br>
      个人专属 | 
      <a href="https://wangrui15034005712.github.io">博客-Wang Rui</a>
      
	  <br>
	  <span id="timeDate" style="align:center;">载入天数...</span><span id="times">载入时分秒...</span><br>
	  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	      
      <span id="busuanzi_container_site_pv">
		本站总访问量<span id="busuanzi_value_site_pv"></span>次
	  </span>
		  <span id="busuanzi_container_site_uv">
	  总访客数<span id="busuanzi_value_site_uv"></span>人次
	  </span>
    <br>
    <span><a href="http://www.beian.miit.gov.cn" target="_blank" rel="nofollow noopener">京ICP备19026555号</a></span>
	</div>
  </div>
    <script>
        var now = new Date(); 
        function createtime() { 
            var grt= new Date("10/11/2018 16:47:00");//此处修改你的建站时间或者网站上线时间 
            now.setTime(now.getTime()+250); 
            days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
            hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
            if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
            mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
            seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
            snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
            document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
            document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
        } 
    setInterval("createtime()",250);
    </script>
</footer>
<style>
body {
  position:relative;
}
.gongyong a {
  width:50px;
  height:50px;
  background:#fff;
  color:#000;
  position:fixed;
  text-align:center;
  line-height:50px;
  right:2%;
  text-decoration:none;
  transition:all 0.5s;
  display:none;
}
.top a {
  top:70%;
}
.bottom a {
  top:80%;
}
.gongyong a.hover {
  background:#e14da0;
}
</style>
<div class="top gongyong">
    <a href="javascript:void(0);">顶部</a>
</div>
<div class="bottom gongyong">
    <a href="javascript:void(0);">底部</a>
</div>


<script>
$(function() {
    $(window).scroll(function() {
        if ($(window).scrollTop() >= 300) {
            $('.gongyong a').fadeIn(600);
        } else {
            $('.gongyong a').fadeOut(600);
        }
    });
    $('.gongyong a').hover(function() {
        $(this).addClass('hover');
    }, function() {
        $(this).removeClass('hover');
    });
    $('.top a').click(function() {
        $("html,body").animate({
            scrollTop: 0
        }, 500);
    });
    $('.bottom a').click(function() {
        $("html,body").animate({
            scrollTop: $(document).height()
        }, 500);
    });
});
</script>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  <link rel="stylesheet" href="/blog/plugin/fancybox/jquery.fancybox.css">
  <script src="/blog/plugin/fancybox/jquery.fancybox.pack.js"></script>



  <link rel="stylesheet" href="/blog/plugin/galmenu/GalMenu.css">
  <script src="/blog/plugin/galmenu/GalMenu.js"></script>
  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/blog/" title="" class="menuItem">首页</a>
          
            <a href="/blog/tags" title="" class="menuItem">标签</a>
          
            <a href="/blog/categories" title="" class="menuItem">分类</a>
          
            <a href="/blog/archives" title="" class="menuItem">归档</a>
          
            <a href="/blog/about" title="" class="menuItem">关于</a>
          
            <a href="/blog/photos" title="" class="menuItem">相册</a>
          
        </div>
        
          <audio id="audio" src="#"></audio><!--plugin/galmenu/wulusai.mp3-->
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>
<script src="/blog/js/script.js"></script>




  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("DuYpeY6f1On4Wk78t8VpuhkQ-gzGzoHsz", "udjkMETY7r4RNMLz00VLmsez");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.article-title').length > 1) {
        showTime(Counter);
      }
    });
  </script>




  </div>
</body>
</html>